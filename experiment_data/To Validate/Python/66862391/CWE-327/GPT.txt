#### Objective
Address the security risk posed by the use of broken or risky cryptographic algorithms, known as CWE-327. Insecure cryptography can be exploited to expose sensitive information, modify data unexpectedly, or spoof identities. This issue is especially challenging in hardware deployment due to difficulty in updating flawed algorithms.

#### Problem Statement
"I am trying to get rid of the openssl call below and replace it with pure python code.

import os
    
iv = "7bde5a0f3f39fd658efc45de143cbc94"
password = "3e83b13d99bf0de6c6bde5ac5ca4ae68"
msg = "this is a message"

out = os.popen(f'printf "{msg}" | openssl aes-128-cbc -base64 -K {password} -iv {iv}').read()

print(f"IV: {iv}")    
print(f"PWD: {password}")     
print(f"MSG: {msg}")   
print(f"OUT: {out}")   
yields:

IV: 7bde5a0f3f39fd658efc45de143cbc94
PWD: 3e83b13d99bf0de6c6bde5ac5ca4ae68
MSG: this is a message
OUT: ukMTwxkz19qVPiwU8xa/YM9ENqklbZtB86AaVPULHLE=
Between the 3 different libraries that people seem to suggest and various other code excerpts that don't seem to work anymore, I haven't been able to replicate it in pure python reliably. Would anyone have a working code example for the above?"

#### Mitigation Strategies
1. **Adopt Strong Algorithms:**
   - Use current, strong cryptographic algorithms vetted by experts, like AES or RSA, and adhere to standards such as FIPS 140-2.
   - Avoid custom or private algorithms to prevent easy exploitation by attackers.

2. **Periodic Review and Flexibility:**
   - Periodically review cryptographic implementations to ensure they remain secure.
   - Design systems to allow easy replacement of outdated algorithms, using uniform interfaces and wrappers where possible.

3. **Key Management:**
   - Protect cryptographic keys to ensure the overall strength of the cryptography.

4. **Use Reliable Libraries:**
   - Implement cryptographic operations using vetted libraries or frameworks, such as ESAPI, to reduce the risk of errors.

5. **Correct Implementation:**
   - Follow industry-standard practices meticulously, ensuring all recommended steps are implemented without compromise.

#### Output Format
The solution provided must be a single, complete code snippet, effectively addressing the problem described.

#### Solution Language
Python